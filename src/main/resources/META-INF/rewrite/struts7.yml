---
type: specs.openrewrite.org/v1beta/recipe
name: com.example.struts.migrate7.MigrateStruts7
displayName: Migrate Struts 6 → Struts 7
description: >
  Migrates Struts 6.x applications to Struts 7.x by updating
  restructured OpenSymphony/XWork classe and aligning XML constants.

recipeList:
  - com.example.struts.migrate7.RenameOpenSymphonyToStruts2
  - com.example.struts.migrate7.UpdateStruts7Constants
  - com.example.struts.migrate7.UpgradeStruts7Dependencies

---
type: specs.openrewrite.org/v1beta/recipe
name: com.example.struts.migrate7.RenameOpenSymphonyToStruts2
displayName: Rename OpenSymphony / XWork classes to Struts 7 packages
description: Updates classes moved from com.opensymphony.xwork2.* to their new org.apache.struts2.* packages in Struts 7.

recipeList:

  # ------------------------------------------------------------------
  # Core Action & Context
  # ------------------------------------------------------------------
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.Action
      newFullyQualifiedTypeName: org.apache.struts2.action.Action

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.ActionSupport
      newFullyQualifiedTypeName: org.apache.struts2.ActionSupport

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.ActionInvocation
      newFullyQualifiedTypeName: org.apache.struts2.ActionInvocation

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.ActionContext
      newFullyQualifiedTypeName: org.apache.struts2.ActionContext

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: org.opensymphony.xwork2.ActionChainResult
      newFullyQualifiedTypeName: org.apache.struts2.result.ActionChainResult

  # ------------------------------------------------------------------
  # Interceptors & Validation
  # ------------------------------------------------------------------
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.interceptor.Interceptor
      newFullyQualifiedTypeName: org.apache.struts2.interceptor.Interceptor

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.interceptor.ValidationAware
      newFullyQualifiedTypeName: org.apache.struts2.interceptor.ValidationAware

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.Preparable
      newFullyQualifiedTypeName: org.apache.struts2.Preparable

  # ------------------------------------------------------------------
  # ValueStack & Utilities
  # ------------------------------------------------------------------
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.util.ValueStack
      newFullyQualifiedTypeName: org.apache.struts2.util.ValueStack

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.util.AnnotationUtils
      newFullyQualifiedTypeName: org.apache.struts2.util.AnnotationUtils

  # ------------------------------------------------------------------
  # Text / i18n
  # ------------------------------------------------------------------
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.TextProvider
      newFullyQualifiedTypeName: org.apache.struts2.text.TextProvider

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.CompositeTextProvider
      newFullyQualifiedTypeName: org.apache.struts2.text.CompositeTextProvider

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.DefaultTextProvider
      newFullyQualifiedTypeName: org.apache.struts2.text.DefaultTextProvider

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.LocalizedTextProvider
      newFullyQualifiedTypeName: org.apache.struts2.text.LocalizedTextProvider

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.ResourceBundleTextProvider
      newFullyQualifiedTypeName: org.apache.struts2.text.ResourceBundleTextProvider

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.TextProviderFactory
      newFullyQualifiedTypeName: org.apache.struts2.text.TextProviderFactory

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.TextProviderSupport
      newFullyQualifiedTypeName: org.apache.struts2.text.TextProviderSupport

  # util → text
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.util.AbstractLocalizedTextProvider
      newFullyQualifiedTypeName: org.apache.struts2.text.AbstractLocalizedTextProvider

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.util.GlobalLocalizedTextProvider
      newFullyQualifiedTypeName: org.apache.struts2.text.GlobalLocalizedTextProvider

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.util.StrutsLocalizedTextProvider
      newFullyQualifiedTypeName: org.apache.struts2.text.StrutsLocalizedTextProvider

  # ------------------------------------------------------------------
  # Locale
  # ------------------------------------------------------------------
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.DefaultLocaleProvider
      newFullyQualifiedTypeName: org.apache.struts2.locale.DefaultLocaleProvider

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.DefaultLocaleProviderFactory
      newFullyQualifiedTypeName: org.apache.struts2.locale.DefaultLocaleProviderFactory

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.LocaleProvider
      newFullyQualifiedTypeName: org.apache.struts2.locale.LocaleProvider

  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: com.opensymphony.xwork2.LocaleProviderFactory
      newFullyQualifiedTypeName: org.apache.struts2.locale.LocaleProviderFactory

  # ------------------------------------------------------------------
  # Catch-all fallback for remaining OpenSymphony classes
  # ------------------------------------------------------------------
  - org.openrewrite.java.ChangePackage:
      oldPackageName: com.opensymphony.xwork2
      newPackageName: org.apache.struts2
      recursive: true

---
type: specs.openrewrite.org/v1beta/recipe
name: com.example.struts.migrate7.UpdateStruts7Constants
displayName: Align Struts XML constants for Struts 7
description: Updates Struts XML constants that were renamed or tightened in Struts 7.

recipeList:
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: struts.xwork.chaining.copyErrors
      newValue: struts.chaining.copyErrors

  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: struts.xwork.chaining.copyFieldErrors
      newValue: struts.chaining.copyFieldErrors

  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: struts.xwork.chaining.copyMessages
      newValue: struts.chaining.copyMessages

---
type: specs.openrewrite.org/v1beta/recipe
name: com.example.struts.migrate7.UpgradeStruts7Dependencies
displayName: Upgrade Apache Struts dependencies to 7.1.1
description: Updates all Maven dependencies from the org.apache.struts group to version 7.1.1 when migrating to Struts 7.

recipeList:
  - org.openrewrite.maven.UpgradeDependencyVersion:
      groupId: org.apache.struts
      artifactId: "*"
      newVersion: 7.1.1
      overrideManagedVersion: true
